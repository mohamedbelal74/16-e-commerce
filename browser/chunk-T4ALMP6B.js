import{a as x,b as a,c as M,d as S,h as w,i as I,j as N,k as A,l as E,n as G}from"./chunk-FDJINMMM.js";import{a as O}from"./chunk-MNBUXWPO.js";import"./chunk-5TUTK4RD.js";import{d as F,f as _}from"./chunk-GUJGMTCI.js";import{$b as m,Cb as p,Dc as k,Eb as h,Na as n,Pb as r,Rb as f,Z as c,Za as C,cb as v,qb as u,rb as l,sb as o,tb as d,xc as b,zc as y}from"./chunk-7JRWEJT7.js";var g=(i,t)=>({"border-red-500":i,"border-green-500":t});function T(i,t){if(i&1&&(l(0,"div",16),r(1),o()),i&2){let s=h();n(),f(" ",s.successMessage," ")}}function P(i,t){if(i&1&&(l(0,"div",17),r(1),o()),i&2){let s=h();n(),f(" ",s.errorMessage," ")}}var V=class i{fb=c(E);activatedRoute=c(F);cartService=c(O);router=c(_);checkOutForm;id=null;successMessage="";errorMessage="";ngOnInit(){this.initForm(),this.getCartId()}getCartId(){this.activatedRoute.paramMap.subscribe({next:t=>{this.id=t.get("id"),console.log("Cart ID:",this.id)}})}initForm(){this.checkOutForm=this.fb.group({shippingAddress:this.fb.group({details:[null,[a.required,a.minLength(5)]],phone:[null,[a.required,a.pattern(/^01[0-2,5]{1}[0-9]{8}$/)]],city:[null,[a.required]]})})}get detailsControl(){return this.checkOutForm.get("shippingAddress.details")}get phoneControl(){return this.checkOutForm.get("shippingAddress.phone")}get cityControl(){return this.checkOutForm.get("shippingAddress.city")}submitVisa(){this.checkOutForm.valid&&this.id?this.cartService.checkOutSession(this.id,this.checkOutForm.value).subscribe({next:t=>{console.log(t),t.status==="success"&&t.session?.url&&window.open(t.session.url,"_self"),this.successMessage="Visa checkout completed successfully \u2705"},error:t=>{console.log(t),this.errorMessage="Visa checkout failed \u274C"}}):(this.checkOutForm.markAllAsTouched(),this.errorMessage="Please fill out all required fields \u274C")}submitCash(){this.checkOutForm.valid&&this.id?this.cartService.checkOutSessionCash(this.id,this.checkOutForm.value).subscribe({next:t=>{console.log(t),t.status==="success"&&(this.successMessage="Cash checkout completed successfully \u2705",this.router.navigate(["/allorders"]))},error:t=>{console.log(t),this.errorMessage="Cash checkout failed \u274C"}}):(this.checkOutForm.markAllAsTouched(),this.errorMessage="Please fill out all required fields \u274C")}static \u0275fac=function(s){return new(s||i)};static \u0275cmp=C({type:i,selectors:[["app-checkout"]],decls:25,vars:15,consts:[[1,"mt-20"],[1,"space-y-5","flex","items-center","justify-center","flex-col",3,"formGroup"],["formGroupName","shippingAddress",1,"w-[40%]"],[1,"text-center","mb-10"],[1,"text-3xl","text-green-600"],["for","details",1,"block","mb-1","font-medium","text-gray-700"],["id","details","formControlName","details",1,"w-full","p-2","border","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngClass"],["for","phone",1,"block","mb-1","font-medium","text-gray-700"],["id","phone","type","text","formControlName","phone",1,"w-full","p-2","border","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngClass"],["for","city",1,"block","mb-1","font-medium","text-gray-700"],["id","city","type","text","formControlName","city",1,"w-full","p-2","border","rounded-lg","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngClass"],[1,"flex","gap-5","w-[40%]"],["type","button",1,"flex-1","py-2","px-4","bg-green-600","hover:bg-green-700","text-white","font-semibold","rounded-lg","shadow-md","transition",3,"click"],["type","button",1,"flex-1","py-2","px-4","bg-blue-600","hover:bg-blue-700","text-white","font-semibold","rounded-lg","shadow-md","transition",3,"click"],["class","mt-4 text-green-600 font-semibold",4,"ngIf"],["class","mt-4 text-red-600 font-semibold",4,"ngIf"],[1,"mt-4","text-green-600","font-semibold"],[1,"mt-4","text-red-600","font-semibold"]],template:function(s,e){s&1&&(l(0,"section",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"h1",4),r(5,"CheckOut"),o()(),l(6,"div")(7,"label",5),r(8,"Address Details"),o(),d(9,"textarea",6),o(),l(10,"div")(11,"label",7),r(12,"Phone"),o(),d(13,"input",8),o(),l(14,"div")(15,"label",9),r(16,"City"),o(),d(17,"input",10),o()(),l(18,"div",11)(19,"button",12),p("click",function(){return e.submitVisa()}),r(20," Pay with Visa "),o(),l(21,"button",13),p("click",function(){return e.submitCash()}),r(22," Pay with Cash "),o()(),v(23,T,2,1,"div",14)(24,P,2,1,"div",15),o()()),s&2&&(n(),u("formGroup",e.checkOutForm),n(8),u("ngClass",m(6,g,(e.detailsControl==null?null:e.detailsControl.touched)&&(e.detailsControl==null?null:e.detailsControl.invalid),(e.detailsControl==null?null:e.detailsControl.touched)&&(e.detailsControl==null?null:e.detailsControl.valid))),n(4),u("ngClass",m(9,g,(e.phoneControl==null?null:e.phoneControl.touched)&&(e.phoneControl==null?null:e.phoneControl.invalid),(e.phoneControl==null?null:e.phoneControl.touched)&&(e.phoneControl==null?null:e.phoneControl.valid))),n(4),u("ngClass",m(12,g,(e.cityControl==null?null:e.cityControl.touched)&&(e.cityControl==null?null:e.cityControl.invalid),(e.cityControl==null?null:e.cityControl.touched)&&(e.cityControl==null?null:e.cityControl.valid))),n(6),u("ngIf",e.successMessage),n(),u("ngIf",e.errorMessage))},dependencies:[G,w,x,M,S,I,A,N,k,b,y],encapsulation:2})};export{V as CheckoutComponent};
