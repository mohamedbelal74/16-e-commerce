import{a as k}from"./chunk-NRV5PKAH.js";import{a as T,b as f,c as L,d as G,h as N,i as q,k as R,l as B,n as M}from"./chunk-FDJINMMM.js";import{a as V}from"./chunk-5TUTK4RD.js";import{f as F}from"./chunk-GUJGMTCI.js";import{Cb as E,Eb as c,Na as r,Nb as u,Pb as l,Wb as C,Xb as _,Yb as x,Z as g,Za as P,da as v,ea as w,fa as y,ga as S,lb as d,mb as m,qb as b,rb as o,sb as n,tb as p,zb as h}from"./chunk-7JRWEJT7.js";function I(t,a){t&1&&(o(0,"li"),l(1,"Email is required"),n())}function j(t,a){t&1&&(o(0,"li"),l(1,"Please enter a valid email"),n())}function O(t,a){if(t&1&&(o(0,"div",15)(1,"ul",17),d(2,I,2,0,"li"),d(3,j,2,0,"li"),n()()),t&2){c();let i=x(4);r(2),m(i.hasError("required")?2:-1),r(),m(i.hasError("email")?3:-1)}}function A(t,a){if(t&1){let i=h();o(0,"form",10),E("ngSubmit",function(){v(i);let s=c();return w(s.formStep1())}),o(1,"h2",11),l(2,"Verify Email"),n(),o(3,"div",12),C(4),o(5,"label",13),l(6,"Email"),n(),p(7,"input",14),d(8,O,4,2,"div",15),n(),o(9,"button",16),l(10," Verify Email "),n()()}if(t&2){let i=c();b("formGroup",i.verifyEmail),r(4);let e=_(i.verifyEmail.controls.email);r(3),u("border-green-600",e==null?null:e.valid)("border-red-600",(e==null?null:e.invalid)&&(e==null?null:e.touched)),r(),m(e.errors&&e.touched?8:-1)}}function H(t,a){t&1&&(o(0,"li"),l(1,"Reset code is required"),n())}function $(t,a){if(t&1&&(o(0,"div",15)(1,"ul",17),d(2,H,2,0,"li"),n()()),t&2){c();let i=x(4);r(2),m(i.hasError("required")?2:-1)}}function z(t,a){if(t&1){let i=h();o(0,"form",10),E("ngSubmit",function(){v(i);let s=c();return w(s.formStep2())}),o(1,"h2",11),l(2,"Enter Reset Code"),n(),o(3,"div",12),C(4),o(5,"label",18),l(6,"Reset Code"),n(),p(7,"input",19),d(8,$,3,1,"div",15),n(),o(9,"button",16),l(10," Verify Code "),n()()}if(t&2){let i=c();b("formGroup",i.verifyCode),r(4);let e=_(i.verifyCode.controls.resetCode);r(3),u("border-green-600",e==null?null:e.valid)("border-red-600",(e==null?null:e.invalid)&&(e==null?null:e.touched)),r(),m(e.errors&&e.touched?8:-1)}}function J(t,a){t&1&&(o(0,"li"),l(1,"Email is required"),n())}function K(t,a){t&1&&(o(0,"li"),l(1,"Please enter a valid email"),n())}function Q(t,a){if(t&1&&(o(0,"div",15)(1,"ul",17),d(2,J,2,0,"li"),d(3,K,2,0,"li"),n()()),t&2){c();let i=x(4);r(2),m(i.hasError("required")?2:-1),r(),m(i.hasError("email")?3:-1)}}function U(t,a){t&1&&(o(0,"li"),l(1,"Password is required"),n())}function W(t,a){t&1&&(o(0,"li"),l(1,"Password must be at least 6 characters"),n())}function X(t,a){if(t&1&&(o(0,"div",15)(1,"ul",17),d(2,U,2,0,"li"),d(3,W,2,0,"li"),n()()),t&2){c();let i=x(10);r(2),m(i.hasError("required")?2:-1),r(),m(i.hasError("pattern")?3:-1)}}function Y(t,a){if(t&1){let i=h();o(0,"form",10),E("ngSubmit",function(){v(i);let s=c();return w(s.formStep3())}),o(1,"h2",11),l(2,"Reset Password"),n(),o(3,"div",12),C(4),o(5,"label",20),l(6,"Email"),n(),p(7,"input",21),d(8,Q,4,2,"div",15),n(),o(9,"div",12),C(10),o(11,"label",22),l(12,"New Password"),n(),p(13,"input",23),d(14,X,4,2,"div",15),n(),o(15,"button",16),l(16," Reset Password "),n()()}if(t&2){let i=c();b("formGroup",i.resetPassword),r(4);let e=_(i.resetPassword.controls.email);r(3),u("border-green-600",e==null?null:e.valid)("border-red-600",(e==null?null:e.invalid)&&(e==null?null:e.touched)),r(),m(e.errors&&e.touched?8:-1),r(2);let s=_(i.resetPassword.controls.newPassword);r(3),u("border-green-600",s==null?null:s.valid)("border-red-600",(s==null?null:s.invalid)&&(s==null?null:s.touched)),r(),m(s.errors&&s.touched?14:-1)}}var D=class t{formBuilder=g(B);authService=g(k);cookieService=g(V);router=g(F);verifyEmail;verifyCode;resetPassword;step=1;ngOnInit(){this.initForm()}initForm(){this.verifyEmail=this.formBuilder.group({email:[null,[f.required,f.email]]}),this.verifyCode=this.formBuilder.group({resetCode:[null,[f.required]]}),this.resetPassword=this.formBuilder.group({newPassword:[null,[f.required,f.pattern(/^\w{6,}$/)]]})}formStep1(){this.verifyEmail.valid&&this.authService.submitVerifyEmail(this.verifyEmail.value).subscribe({next:a=>{console.log(a),this.step=2},error:a=>{console.error(a)}})}formStep2(){this.verifyCode.valid&&this.authService.submitVerifyCode(this.verifyCode.value).subscribe({next:a=>{console.log(a),this.step=3},error:a=>{console.error(a)}})}formStep3(){if(this.resetPassword.valid){let a={email:this.verifyEmail.get("email")?.value,newPassword:this.resetPassword.get("newPassword")?.value};this.authService.submitResetPassword(a).subscribe({next:i=>{console.log(i),this.cookieService.set("token",i.token,{path:"/"}),this.cookieService.set("userId",i.user._id,{path:"/"}),this.router.navigate(["/home"])},error:i=>{console.error(i)}})}}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=P({type:t,selectors:[["app-forgot-password"]],decls:26,vars:19,consts:[[1,"mt-20"],[1,"container","max-w-lg","mx-auto","space-y-8"],[1,"flex","items-center","w-full","p-3","space-x-2","text-sm","font-medium","text-center","text-gray-500","bg-white","border","border-gray-200","rounded-lg","shadow-xs","sm:text-base","sm:p-4","sm:space-x-4","rtl:space-x-reverse"],[1,"flex","items-center"],[1,"flex","items-center","justify-center","w-5","h-5","me-2","text-xs","border","rounded-full","shrink-0"],[1,"hidden","sm:inline-flex","sm:ms-2"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 12 10",1,"w-3","h-3","ms-2","sm:ms-4","rtl:rotate-180"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","m7 9 4-4-4-4M1 9l4-4-4-4"],[1,"flex","items-center","justify-center","w-5","h-5","me-2","text-xs","border","border-gray-500","rounded-full","shrink-0"],[1,"bg-white","shadow-md","rounded-lg","p-6","border","border-gray-200",3,"formGroup"],[1,"bg-white","shadow-md","rounded-lg","p-6","border","border-gray-200",3,"ngSubmit","formGroup"],[1,"text-lg","font-semibold","text-gray-800","mb-4"],[1,"mb-4"],["for","email",1,"block","mb-2","text-sm","font-medium","text-gray-700"],["id","email","type","email","formControlName","email","placeholder","Enter your email",1,"bg-gray-50","border","text-sm","rounded-lg","block","w-full","p-2.5","transition-colors","duration-200","border-gray-300","focus:ring-2","focus:ring-green-500","focus:border-green-500","focus:outline-none"],[1,"mt-2","p-3","text-sm","text-red-700","rounded-lg","bg-red-50","border","border-red-200"],["type","submit",1,"w-full","bg-green-600","text-white","py-2","px-4","rounded-lg","shadow","hover:bg-green-700","transition"],[1,"list-disc","list-inside","space-y-1"],["for","resetCode",1,"block","mb-2","text-sm","font-medium","text-gray-700"],["id","resetCode","type","text","formControlName","resetCode","placeholder","Enter the code sent to your email",1,"bg-gray-50","border","text-sm","rounded-lg","block","w-full","p-2.5","transition-colors","duration-200","border-gray-300","focus:ring-2","focus:ring-green-500","focus:border-green-500","focus:outline-none"],["for","resetEmail",1,"block","mb-2","text-sm","font-medium","text-gray-700"],["id","resetEmail","type","email","formControlName","email","placeholder","Enter your email again",1,"bg-gray-50","border","text-sm","rounded-lg","block","w-full","p-2.5","transition-colors","duration-200","border-gray-300","focus:ring-2","focus:ring-green-500","focus:border-green-500","focus:outline-none"],["for","newPassword",1,"block","mb-2","text-sm","font-medium","text-gray-700"],["id","newPassword","type","password","formControlName","newPassword","placeholder","Enter new password",1,"bg-gray-50","border","text-sm","rounded-lg","block","w-full","p-2.5","transition-colors","duration-200","border-gray-300","focus:ring-2","focus:ring-green-500","focus:border-green-500","focus:outline-none"]],template:function(i,e){i&1&&(o(0,"section",0)(1,"div",1)(2,"ol",2)(3,"li",3)(4,"span",4),l(5," 1 "),n(),l(6," Verify "),o(7,"span",5),l(8,"Email"),n(),y(),o(9,"svg",6),p(10,"path",7),n()(),S(),o(11,"li",3)(12,"span",8),l(13," 2 "),n(),l(14," Verify "),o(15,"span",5),l(16,"Code"),n(),y(),o(17,"svg",6),p(18,"path",7),n()(),S(),o(19,"li",3)(20,"span",8),l(21," 3 "),n(),l(22," Reset Password "),n()(),d(23,A,11,7,"form",9)(24,z,11,7,"form",9)(25,Y,17,13,"form",9),n()()),i&2&&(r(3),u("text-green-600",e.step===1),r(),u("text-green-600",e.step===1)("border-green-600",e.step===1),r(7),u("text-green-600",e.step===2),r(),u("text-green-600",e.step===2)("border-green-600",e.step===2),r(7),u("text-green-600",e.step===3),r(),u("text-green-600",e.step===3)("border-green-600",e.step===3),r(3),m(e.step===1?23:e.step===2?24:e.step===3?25:-1))},dependencies:[M,N,T,L,G,q,R],encapsulation:2})};export{D as ForgotPasswordComponent};
