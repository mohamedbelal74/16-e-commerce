<section>
  <h2 class="text-4xl text-center my-3 text-green-600 mt-20 font-bold drop-shadow-lg">Register Now</h2>



  
  <form class="w-[80%] p-5 mx-auto shadow-md rounded-md" [formGroup]="registerForm" (ngSubmit)="submit()">

@if (errorMsg!='') {
<div *ngIf="showToast" id="toast-danger"
  class="flex items-center w-full max-w-xs p-4 mb-4 text-gray-500 bg-red-200 rounded-lg shadow-sm dark:text-gray-400 dark:bg-gray-800"
  role="alert">

  <div class="inline-flex items-center justify-center shrink-0 w-8 h-8 text-red-500 bg-red-300 rounded-lg dark:bg-red-800 dark:text-red-200">
    <i class="fa-solid fa-arrow-right"></i>
  </div>

  <div class="ms-3 text-sm font-normal">{{ errorMsg }}</div>

  <button (click)="showToast = false" type="button"
    class="ms-auto -mx-1.5 -my-1.5 bg-white text-gray-400 hover:text-gray-900 rounded-lg focus:ring-2 focus:ring-gray-300 p-0.5 hover:bg-gray-100 inline-flex items-center justify-center h-8 w-8 dark:text-gray-500 dark:hover:text-white dark:bg-gray-800 dark:hover:bg-gray-700">
    
    <i class="fa-solid fa-square-xmark text-red-500"></i>
  </button>
</div>
}


<!-- Name -->
<div class="mb-4">
  @let nameControls = registerForm.controls['name'];

  <label for="name" class="block mb-2 text-sm font-medium text-gray-700">Name</label>
  <input
    id="name"
    type="text"
    formControlName="name"
    class="bg-white border text-sm rounded-lg block w-full p-2.5 transition-colors duration-200
           border-gray-300 focus:ring-2 focus:ring-green-500 focus:outline-none"
    [class.border-green-600]="nameControls?.valid"
    [class.border-red-600]="nameControls?.invalid && nameControls?.touched"
  />

  @if (nameControls.errors && nameControls.touched) {
    <div class="mt-2 p-3 text-sm text-red-700 rounded-lg bg-red-50 border border-red-200">
      <ul class="list-disc list-inside space-y-1">
        @if (nameControls.hasError('required')) { <li>Name is required</li> }
        @if (nameControls.hasError('minlength')) { <li>Minimum 3 characters</li> }
        @if (nameControls.hasError('maxlength')) { <li>Maximum 20 characters</li> }
      </ul>
    </div>
  }
</div>




   <!-- Email -->
<div class="mb-4">
  @let emailControls = registerForm.controls['email'];

  <label for="email" class="block mb-2 text-sm font-medium text-gray-700">Email</label>
  <input
    id="email"
    type="email"
    formControlName="email"
    class="bg-white border text-sm rounded-lg block w-full p-2.5 transition-colors duration-200
           border-gray-300 focus:ring-2 focus:ring-green-500 focus:outline-none"
    [class.border-green-600]="emailControls?.valid"
    [class.border-red-600]="emailControls?.invalid && emailControls?.touched"
  />

  @if (emailControls.errors && emailControls.touched) {
    <div class="mt-2 p-3 text-sm text-red-700 rounded-lg bg-red-50 border border-red-200">
      <ul class="list-disc list-inside space-y-1">
        @if (emailControls.hasError('required')) { <li>Email is required</li> }
        @if (emailControls.hasError('email')) { <li>Enter a valid email</li> }
      </ul>
    </div>
  }
</div>

<!-- password -->

<div class="mb-4 ">
  @let passwordControls = registerForm.controls['password'];

  <label for="password" class="block mb-2 relative text-sm font-medium text-gray-700">
    Password

    <span (click)="flag = !flag" class="absolute right-3 top-[38px] cursor-pointer text-gray-500">
   @if(flag){
  <i class="fas fa-eye"></i>
 }@else {
    <i class="fas fa-eye-slash"></i>
 }
</span>
  </label>
  <input
    id="password"
    [type]="flag? 'password': 'text'"
    formControlName="password"
    class="bg-white border text-sm rounded-lg block w-full p-2.5 transition-colors duration-200
           border-gray-300 focus:ring-2 focus:ring-green-500 focus:outline-none"
   
  />

  @if (passwordControls.errors && passwordControls.touched) {
    <div class="mt-2 p-3 text-sm text-red-700 rounded-lg bg-red-50 border border-red-200">
      <ul class="list-disc list-inside space-y-1">
        @if (passwordControls.hasError('required')) {
          <li>Password is required</li>
        }
        @if (passwordControls.hasError('minlength')) {
          <li>Minimum 6 characters</li>
        }
      </ul>
    </div>
  }
</div>

<!-- Confirm Password -->
 
<div class="mb-4 relative">
  <label for="rePassword" class="block mb-2 text-sm font-medium text-gray-700">
    Confirm Password
  </label>

  <input
    id="rePassword"
    [type]="sign ? 'password' : 'text'"
    formControlName="rePassword"
    class="bg-white border text-sm rounded-lg block w-full p-2.5 pr-10 transition-colors duration-200
           border-gray-300 focus:ring-2 focus:ring-green-500 focus:outline-none"
    [class.border-green-600]="!registerForm.errors?.['misMatch'] && registerForm.get('rePassword')?.valid"
    [class.border-red-600]="registerForm.errors?.['misMatch'] && registerForm.get('rePassword')?.touched"
  />

  
  <span (click)="sign = !sign" class="absolute right-3 top-[38px] cursor-pointer text-gray-500">
    @if (sign) {
      <i class="fas fa-eye"></i>
    } @else {
      <i class="fas fa-eye-slash"></i>
    }
  </span>

  
  @if (registerForm.errors?.['misMatch'] && registerForm.get('rePassword')?.touched) {
    <div class="mt-2 p-3 text-sm text-red-700 rounded-lg bg-red-50 border border-red-200">
      <ul class="list-disc list-inside space-y-1">
        <li>Passwords do not match</li>
      </ul>
    </div>
  }
</div>




<!-- phone -->



<div class="mb-4">
  @let phoneControls = registerForm.controls['phone'];

  <label for="phone" class="block mb-2 text-sm font-medium text-gray-700">Phone</label>
  <input
    id="phone"
    type="tel"
    formControlName="phone"
    class="bg-white border text-sm rounded-lg block w-full p-2.5 transition-colors duration-200
           border-gray-300 focus:ring-2 focus:ring-green-500 focus:outline-none"
    [class.border-green-600]="phoneControls?.valid"
    [class.border-red-600]="phoneControls?.invalid && phoneControls?.touched"
  />

  @if (phoneControls.errors && phoneControls.touched) {
    <div class="mt-2 p-3 text-sm text-red-700 rounded-lg bg-red-50 border border-red-200">
      <ul class="list-disc list-inside space-y-1">
        @if (phoneControls.hasError('required')) { <li>Phone is required</li> }
        @if (phoneControls.hasError('pattern')) { <li>Enter a valid Egyptian phone number</li> }
      </ul>
    </div>
  }
</div>
 
    <button class="btn-main " type="submit"[disabled]="isLoading" >
      Register
      @if (isLoading) {
        <i class="fa-solid fa-spinner fa-spin"></i>
      }
    </button>
  </form>
</section>

